SET(EXTPREFIX_ocio "${EXTPREFIX}" )

if(APPLE)
    if(CMAKE_SYSTEM_PROCESSOR STREQUAL "arm64")
        set(SSE_OPTIMIZATIONS_STRING "-DCMAKE_OSX_ARCHITECTURES=arm64")
    endif()
endif()

ExternalProject_Add(
    ext_ocio
    DOWNLOAD_DIR ${EXTERNALS_DOWNLOAD_DIR}
    URL https://github.com/AcademySoftwareFoundation/OpenColorIO/archive/445c45b0160d55b3334fb7530c1164e041a0e34f.tar.gz
    URL_HASH SHA256=7bbc20f5340ee1f59ca649dc0297536912d73ce01d18a967ce7bfe4acaed1820

    PATCH_COMMAND ${PATCH_COMMAND} -p1 -i ${CMAKE_CURRENT_SOURCE_DIR}/0001-Propagate-Android-CMake-configuration-to-external-pr.patch

    INSTALL_DIR ${EXTPREFIX_ocio}

    CMAKE_ARGS -DCMAKE_INSTALL_PREFIX=${EXTPREFIX_ocio} -DCMAKE_BUILD_TYPE=${GLOBAL_BUILD_TYPE} ${GLOBAL_PROFILE} -DOCIO_BUILD_NUKE:BOOL=OFF -DOCIO_BUILD_DOCS:BOOL=OFF -DOCIO_BUILD_TESTS:BOOL=OFF -DOCIO_BUILD_GPU_TESTS:BOOL=OFF -DOCIO_BUILD_PYTHON:BOOL=OFF -DOCIO_INSTALL_EXT_PACKAGES=MISSING ${SSE_OPTIMIZATIONS_STRING}

    UPDATE_COMMAND ""
)
